# This file is copied to spec/ when you run 'rails generate rspec:install'
ENV['RAILS_ENV'] ||= 'test'
require File.expand_path('../../config/environment', __FILE__)
# Prevent database truncation if the environment is production
abort("The Rails environment is running in production mode!") if Rails.env.production?
require 'spec_helper'
require 'rspec/rails'
require 'mock_auth_helper'
require 'sidekiq/testing'
Sidekiq::Testing.disable!
include ActionDispatch::TestProcess

class ApiCaller
  def self.get(url)
    stubs = Faraday::Adapter::Test::Stubs.new do |stub|
      stub.get('/bar') { |env| [200, {}, 'BAR'] }
    end
    test = Faraday.new do |builder|
      builder.adapter :test, stubs do |stub|
        stub.get('/foo') { |env| [200, {}, 'Hello world'] }
        stub.get('/100/914bbs.txt') { |env| [200, {}, 'SUFFICIENT CREDIT SHOULD BE GIVEN']}
        stub.get('/v2.10/107106676601926/photos?access_token=EAAEraXpYNBEBAPUf6smSfcCPNF4igzQoSosb4aP3pHM1ECvyLvPhqr3PSpSVGzMH6ZAa5g9NqyAeOJ9VHZCSBFi3TScW3WyjEhGTQLcWs8yVrpux8OvE0VXO3ueJgzke2koxPviVkJz4ehMeIpOZCEcZARE1sG7lFSoNnt4sXH3szeZCF8CS9bvZAYM8nEr2GPndsZBr86DE1lC7cAL2FIjX4MupSnIMdttxEm4n3uMzgZDZD&fields=created_time%2Cfrom%2Cid%2Cimages%2Cname%2Clink%2Cplace%2Ccomments%7Blike_count%2Ccomment_count%2Cmessage%2Clikes%2Cfrom%7D%2Ctags%7Bid%2Cname%7D%2Creactions%7Bid%2Cname%2Cusername%2Ctype%7D&type=uploaded') { |env| [200, {}, %|{\"data\":[{\"created_time\":\"2017-07-26T20:35:48+0000\",\"from\":{\"name\":\"Open Graph Test User\",\"id\":\"107106676601926\"},\"id\":\"108366903142570\",\"images\":[{\"height\":800,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-9\\/20264634_108366903142570_8219777944044560122_n.jpg?oh=603091017e6501494704e219a4c13248&oe=59FE8ED2\",\"width\":674},{\"height\":712,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p600x600\\/20264634_108366903142570_8219777944044560122_n.jpg?oh=90aa73d70792e60a5e912d9478a38f9a&oe=59FB9F89\",\"width\":600},{\"height\":569,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p480x480\\/20264634_108366903142570_8219777944044560122_n.jpg?oh=5317dbb8f009066c4def2fad25da7c78&oe=59FBE769\",\"width\":480},{\"height\":379,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p320x320\\/20264634_108366903142570_8219777944044560122_n.jpg?oh=7ea7f6a4c75ac776e0e8ab3e4040d816&oe=59F13E33\",\"width\":320},{\"height\":540,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p180x540\\/20264634_108366903142570_8219777944044560122_n.jpg?oh=9723a7d2029d0b6596e5d465684fbbc3&oe=59F7798E\",\"width\":454},{\"height\":154,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p130x130\\/20264634_108366903142570_8219777944044560122_n.jpg?oh=8bbb8c92f445b91a59ace4f23e434fd0&oe=59EAEE5C\",\"width\":130},{\"height\":225,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p75x225\\/20264634_108366903142570_8219777944044560122_n.jpg?oh=90738912fdaa4961a958151aeb9d0524&oe=59F73F28\",\"width\":189}],\"link\":\"https:\\/\\/www.facebook.com\\/photo.php?fbid=108366903142570&set=a.108367163142544.1073741827.100019077828845&type=3\",\"tags\":{\"data\":[{\"id\":\"103107963713589\",\"name\":\"Elizabeth Albjdcaegafbj Greenesen\"}],\"paging\":{\"cursors\":{\"before\":\"MTAzMTA3OTYzNzEzNTg5\",\"after\":\"MTAzMTA3OTYzNzEzNTg5\"}}}},{\"created_time\":\"2017-07-26T20:35:48+0000\",\"from\":{\"name\":\"Open Graph Test User\",\"id\":\"107106676601926\"},\"id\":\"108366899809237\",\"images\":[{\"height\":821,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-8\\/20280374_108366899809237_9201745331159631270_o.jpg?oh=3a55ce5922b484a875287149856f4546&oe=59FC5DD9\",\"width\":1600},{\"height\":720,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-8\\/p720x720\\/20280374_108366899809237_9201745331159631270_o.jpg?oh=d17bef00401b40a9fafd5459246cebfc&oe=59F80F5F\",\"width\":1403},{\"height\":600,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-0\\/p600x600\\/20280374_108366899809237_9201745331159631270_o.jpg?oh=fdff5fdc41b38fc226146b73286fc550&oe=5A086E4A\",\"width\":1169},{\"height\":480,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-0\\/p480x480\\/20280374_108366899809237_9201745331159631270_o.jpg?oh=a232a8b8d5184938f8cb9de2db84b5e2&oe=59F6D9AA\",\"width\":935},{\"height\":320,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p320x320\\/20292860_108366899809237_9201745331159631270_n.jpg?oh=4703965fc40a6ccd8dfbeb8ead4dde31&oe=5A33D809\",\"width\":624},{\"height\":540,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-0\\/p180x540\\/20280374_108366899809237_9201745331159631270_o.jpg?oh=483be4df87c1d9de7bd4c16b31acf29a&oe=5A376A4D\",\"width\":1052},{\"height\":130,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p130x130\\/20292860_108366899809237_9201745331159631270_n.jpg?oh=5e0a9d48965d075f4d91f7ec6e4a4d8b&oe=5A31C266\",\"width\":253},{\"height\":225,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p75x225\\/20292860_108366899809237_9201745331159631270_n.jpg?oh=d9f19fd22477325fda7d1ecaeb5288a4&oe=5A05E412\",\"width\":439}],\"link\":\"https:\\/\\/www.facebook.com\\/photo.php?fbid=108366899809237&set=a.108367163142544.1073741827.100019077828845&type=3\",\"place\":{\"name\":\"Southern Comfort, Denver, CO\"},\"tags\":{\"data\":[{\"id\":\"100935043932836\",\"name\":\"Mark Albjdijbacegb Huisky\"},{\"id\":\"103107963713589\",\"name\":\"Elizabeth Albjdcaegafbj Greenesen\"},{\"id\":\"103572496999291\",\"name\":\"Harry Albjcifbcddgf Schrocksky\"}],\"paging\":{\"cursors\":{\"before\":\"MTAwOTM1MDQzOTMyODM2\",\"after\":\"MTAzNTcyNDk2OTk5Mjkx\"}}}},{\"created_time\":\"2017-07-26T20:35:48+0000\",\"from\":{\"name\":\"Open Graph Test User\",\"id\":\"107106676601926\"},\"id\":\"108366876475906\",\"images\":[{\"height\":1080,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-8\\/20286976_108366876475906_6644110823493177254_o.jpg?oh=a267e008ef117fe42c01709e37da5c93&oe=5A33E165\",\"width\":1920},{\"height\":960,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-8\\/p960x960\\/20286976_108366876475906_6644110823493177254_o.jpg?oh=2d01c829b03244cedee8b0a38a1697a7&oe=59F4F142\",\"width\":1706},{\"height\":720,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-8\\/p720x720\\/20286976_108366876475906_6644110823493177254_o.jpg?oh=409fc5613e051b7f263d5063ccb93f59&oe=5A3732E3\",\"width\":1280},{\"height\":600,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-0\\/p600x600\\/20286976_108366876475906_6644110823493177254_o.jpg?oh=40002648383d542e73658964d35ddafb&oe=5A0142F6\",\"width\":1066},{\"height\":480,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-0\\/p480x480\\/20286976_108366876475906_6644110823493177254_o.jpg?oh=63c6129db9d42a5de5793cbf500a570a&oe=5A059516\",\"width\":853},{\"height\":320,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p320x320\\/20376059_108366876475906_6644110823493177254_n.jpg?oh=f1eb31b43e54ae334b4bc4557772cffb&oe=5A339693\",\"width\":568},{\"height\":540,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-9\\/20376059_108366876475906_6644110823493177254_n.jpg?oh=da00e24e7528d5cdd0eb0c4ba429b473&oe=5A33D872\",\"width\":960},{\"height\":130,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p130x130\\/20376059_108366876475906_6644110823493177254_n.jpg?oh=c1098c832cd473dae89de976a3eaa39b&oe=59EFEDFC\",\"width\":231},{\"height\":225,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p75x225\\/20376059_108366876475906_6644110823493177254_n.jpg?oh=0c127551e3466e31797335619c680d6d&oe=59EE1588\",\"width\":400}],\"link\":\"https:\\/\\/www.facebook.com\\/photo.php?fbid=108366876475906&set=a.108367163142544.1073741827.100019077828845&type=3\",\"tags\":{\"data\":[{\"id\":\"100935043932836\",\"name\":\"Mark Albjdijbacegb Huisky\"},{\"id\":\"103107963713589\",\"name\":\"Elizabeth Albjdcaegafbj Greenesen\"}],\"paging\":{\"cursors\":{\"before\":\"MTAwOTM1MDQzOTMyODM2\",\"after\":\"MTAzMTA3OTYzNzEzNTg5\"}}}},{\"created_time\":\"2017-07-26T20:35:48+0000\",\"from\":{\"name\":\"Open Graph Test User\",\"id\":\"107106676601926\"},\"id\":\"108366873142573\",\"images\":[{\"height\":1280,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-8\\/20414352_108366873142573_3079753416999985853_o.jpg?oh=0e630eb780ec6ae38f036cef18ef6819&oe=59F9D74A\",\"width\":1024},{\"height\":1200,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-8\\/q90\\/p960x960\\/20414352_108366873142573_3079753416999985853_o.jpg?oh=4058df5706049405e38a41da2c1ac4fe&oe=5A30C5DD\",\"width\":960},{\"height\":900,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-8\\/q90\\/p720x720\\/20414352_108366873142573_3079753416999985853_o.jpg?oh=8e4df84ae18043ced20f2cdf5e8fe1db&oe=59FC617C\",\"width\":720},{\"height\":750,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-0\\/q88\\/p600x600\\/20414352_108366873142573_3079753416999985853_o.jpg?oh=bc6b8b511445991319f20b4b0302c4a7&oe=59FD38AF\",\"width\":600},{\"height\":600,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/q88\\/p480x480\\/20292882_108366873142573_3079753416999985853_n.jpg?oh=dfa604343969f18ee3e805ff329e2298&oe=59FA8A45\",\"width\":480},{\"height\":400,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/q84\\/p320x320\\/20292882_108366873142573_3079753416999985853_n.jpg?oh=2ae65e8bd6abfe96bd3c05ed61038cd9&oe=59EED5D8\",\"width\":320},{\"height\":540,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/q84\\/p180x540\\/20292882_108366873142573_3079753416999985853_n.jpg?oh=804dd7b3a776d5e25100f2191a66092c&oe=59FE4165\",\"width\":432},{\"height\":162,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/q84\\/p130x130\\/20292882_108366873142573_3079753416999985853_n.jpg?oh=ab9cbb28316725af06f158e37dc57c75&oe=59EE38B7\",\"width\":130},{\"height\":225,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/q84\\/p75x225\\/20292882_108366873142573_3079753416999985853_n.jpg?oh=15652f56f28ccd6b1b90762f1182e4bc&oe=59F861FD\",\"width\":180}],\"link\":\"https:\\/\\/www.facebook.com\\/photo.php?fbid=108366873142573&set=a.108367163142544.1073741827.100019077828845&type=3\",\"place\":{\"name\":\"Denver Colorado USA\",\"location\":{\"city\":\"Denver\",\"country\":\"United States\",\"latitude\":39.742174798422,\"longitude\":-104.98955281402,\"state\":\"CO\",\"zip\":\"80201\"},\"id\":\"438945516180415\"}},{\"created_time\":\"2017-07-26T20:35:48+0000\",\"from\":{\"name\":\"Open Graph Test User\",\"id\":\"107106676601926\"},\"id\":\"108366869809240\",\"images\":[{\"height\":1080,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-8\\/20248472_108366869809240_6922991253100110829_o.jpg?oh=bf02c03ef9141d27779a0342a32b5ea0&oe=59FDA8AE\",\"width\":1920},{\"height\":960,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-8\\/q81\\/p960x960\\/20248472_108366869809240_6922991253100110829_o.jpg?oh=4557a91519ddd89369ec7c3610e4a913&oe=59F3A776\",\"width\":1706},{\"height\":720,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-8\\/q81\\/p720x720\\/20248472_108366869809240_6922991253100110829_o.jpg?oh=e41ff9ee16d187e444d037fd3eaf7eb8&oe=5A08E2D7\",\"width\":1280},{\"height\":600,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-0\\/q81\\/p600x600\\/20248472_108366869809240_6922991253100110829_o.jpg?oh=83c90aaae8f5f7b7114e0b3f48257b76&oe=59EEE00E\",\"width\":1066},{\"height\":480,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-0\\/q81\\/p480x480\\/20248472_108366869809240_6922991253100110829_o.jpg?oh=bc13e3df5579a9a6b9c51241d4cfbf95&oe=59EDBBEE\",\"width\":853},{\"height\":320,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p320x320\\/20293091_108366869809240_6922991253100110829_n.jpg?oh=8bed904808eacf8d34b44f4f17bc88c7&oe=5A046F96\",\"width\":568},{\"height\":540,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-9\\/20293091_108366869809240_6922991253100110829_n.jpg?oh=4f9c32a0508a0a3aee3ffa70bd036abd&oe=59EE4E77\",\"width\":960},{\"height\":130,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p130x130\\/20293091_108366869809240_6922991253100110829_n.jpg?oh=bb2676fbba580355601ec8c840165a2c&oe=59FA23F9\",\"width\":231},{\"height\":225,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p75x225\\/20293091_108366869809240_6922991253100110829_n.jpg?oh=83e2cf6d076ecd5ea7d854c81a143f80&oe=5A36258D\",\"width\":400}],\"link\":\"https:\\/\\/www.facebook.com\\/photo.php?fbid=108366869809240&set=a.108367163142544.1073741827.100019077828845&type=3\"},{\"created_time\":\"2017-07-26T20:30:20+0000\",\"from\":{\"name\":\"Open Graph Test User\",\"id\":\"107106676601926\"},\"id\":\"108365573142703\",\"images\":[{\"height\":1229,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t31.0-8\\/20248522_108365573142703_5580590224176957739_o.jpg?oh=fd4bdc52ebf4c41823619e54d10ad075&oe=59F0A870\",\"width\":1229},{\"height\":960,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-9\\/20293006_108365573142703_5580590224176957739_n.jpg?oh=d05c5eccb02b0295b5e84ecd7b25b475&oe=5A05D49C\",\"width\":960},{\"height\":720,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-9\\/q81\\/p720x720\\/20293006_108365573142703_5580590224176957739_n.jpg?oh=0032a824265600aed709a398855696af&oe=59FA1346\",\"width\":720},{\"height\":600,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p600x600\\/20293006_108365573142703_5580590224176957739_n.jpg?oh=2515845d99a1aba92bec8fa3700a61d6&oe=5A066CC7\",\"width\":600},{\"height\":480,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p480x480\\/20293006_108365573142703_5580590224176957739_n.jpg?oh=378d79db2ebd645538272bd3a94b92be&oe=5A011827\",\"width\":480},{\"height\":320,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p320x320\\/20293006_108365573142703_5580590224176957739_n.jpg?oh=1dda8323d0d7ddffff27bf9d41a3eab3&oe=59F0CF7D\",\"width\":320},{\"height\":540,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p180x540\\/20293006_108365573142703_5580590224176957739_n.jpg?oh=35592e17b84e9135597e6e07903f7eb9&oe=5A0788C0\",\"width\":540},{\"height\":130,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p130x130\\/20293006_108365573142703_5580590224176957739_n.jpg?oh=5f37b615281e7d24f76907c229210753&oe=5A05BD12\",\"width\":130},{\"height\":225,\"source\":\"https:\\/\\/scontent.xx.fbcdn.net\\/v\\/t1.0-0\\/p75x225\\/20293006_108365573142703_5580590224176957739_n.jpg?oh=3829ec508176b6bc9255d9ec81430054&oe=59EF5B66\",\"width\":225}],\"link\":\"https:\\/\\/www.facebook.com\\/photo.php?fbid=108365573142703&set=a.108365586476035.1073741826.100019077828845&type=3\"}],\"paging\":{\"cursors\":{\"before\":\"MTA4MzY2OTAzMTQyNTcw\",\"after\":\"MTA4MzY1NTczMTQyNzAz\"}}}| ]}
      end
    end
    test.get(url)
  end
end
# Add additional requires below this line. Rails is not loaded until this point!

# Requires supporting ruby files with custom matchers and macros, etc, in
# spec/support/ and its subdirectories. Files matching `spec/**/*_spec.rb` are
# run as spec files by default. This means that files in spec/support that end
# in _spec.rb will both be required and run as specs, causing the specs to be
# run twice. It is recommended that you do not name files matching this glob to
# end with _spec.rb. You can configure this pattern with the --pattern
# option on the command line or in ~/.rspec, .rspec or `.rspec-local`.
#
# The following line is provided for convenience purposes. It has the downside
# of increasing the boot-up time by auto-requiring all files in the support
# directory. Alternatively, in the individual `*_spec.rb` files, manually
# require only the support files necessary.
#
Dir[Rails.root.join('spec/support/**/*.rb')].each { |f| require f }

# Checks for pending migration and applies them before tests are run.
# If you are not using ActiveRecord, you can remove this line.
ActiveRecord::Migration.maintain_test_schema!

RSpec.configure do |config|
  # Remove this line if you're not using ActiveRecord or ActiveRecord fixtures
  config.fixture_path = "#{::Rails.root}/spec/fixtures"

  # If you're not using ActiveRecord, or you'd prefer not to run each of your
  # examples within a transaction, remove the following line or assign false
  # instead of true.
  config.use_transactional_fixtures = false

  # RSpec Rails can automatically mix in different behaviours to your tests
  # based on their file location, for example enabling you to call `get` and
  # `post` in specs under `spec/controllers`.
  #
  # You can disable this behaviour by removing the line below, and instead
  # explicitly tag your specs with their type, e.g.:
  #
  #     RSpec.describe UsersController, :type => :controller do
  #       # ...
  #     end
  #
  # The different available types are documented in the features, such as in
  # https://relishapp.com/rspec/rspec-rails/docs
  config.infer_spec_type_from_file_location!

  # Filter lines from Rails gems in backtraces.
  config.filter_rails_from_backtrace!
  # arbitrary gems may also be filtered via:
  # config.filter_gems_from_backtrace("gem name")

end
Shoulda::Matchers.configure do |config|
  config.integrate do |with|
    with.test_framework :rspec
    with.library :rails
  end
end
